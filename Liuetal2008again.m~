tfinal = 20;
tspan = [0 tfinal];
% y = [V, n_DRK, n_4AP, h_t, s]
y0 = [-60 0 0 0 0];
[t, y] = ode45(@modelo, tspan, y0);

% Variables de estado
% V = y(:,1);
% n_DRK = y(:,2);
% n_4AP = y(:,3);
% h_T = y(:,4);
% s = y(:,5);

% I_inyectada = 1000*(1+square((t-10)/(2*pi),20));
% I_inyectada = 0;
% I =20*(1+chirp(t,0,tfinal,100));
%% Figuras
figure(1)
plot(t,y(:,1),'k')
hold on
% plot(t,I_inyectada,'b')
hold off
xlabel('tiempo (ms)')
% legend('potencial de membrana V_{m} (mV)','corriente inyectada I (nA)')

%% Modelo
function dydt = modelo(t,y)

% Variables de estado
V = y(1);
n_DRK = y(2);
n_4AP = y(3);
h_T = y(4);
s = y(5);


% Parametros
E_K = -92;
E_Na = 50;
E_L = -72;
E_h = -40.8;

% Conductancias maximas (en pS)
g_L = 120;
g_NaT = 1080;
g_NaP = 72;
g_DRK = 600;
g_4AP = 600;
g_h = 2400;

% Capacitancia (en pF)
C = 60;

% Curvas
n_DRK_inf = (1+exp(-(V+4.2)/12.9))^(-1);
tau_DRK = 10;

n_4AP_inf = (1+exp(-(V+43)/3.9))^(-1);
tau_4AP = 2;

m_T_inf = (1+exp(-(V+31.3)/4.3))^(-1);

h_T_inf = (1+exp((V+55)/7.1))^(-1);
tau_NaT = 1.5;

m_P_inf = (1+exp(-(V+50)/6.4))^(-1);

s_inf = (1+exp((V+105)/7.3))^(-1);
tau_s = 100;

% Corrientes (en pA)
I_L = g_L*(V-E_L);
I_DRK = g_DRK*n_DRK*(V-E_K);
I_4AP = g_4AP*n_4AP*(V-E_K);
I_NaP = g_NaP*m_P_inf*(V-E_Na);
I_NaT = g_NaT*m_T_inf*h_T*(V-E_Na);
I_h = g_h*s*(V-E_h);

I = 10*(1+square((t-10)/(2*pi),20));

% Ecuaciones diferenciales
dydt(1) = (1/C)*(I - I_L - I_DRK - I_4AP - I_NaP - I_NaT - I_h);
dydt(2) = (n_DRK_inf - )